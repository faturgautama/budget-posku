<app-layout>
    <!-- Table -->
    <div *ngIf="FormState == 'list'" class="flex flex-col w-full gap-3">
        <div class="flex justify-between items-center bg-white rounded-md p-3 w-full">
            <div class="flex flex-col gap-0">
                <p class="text-blue-500 text-lg font-semibold">
                    Setup Produk
                </p>
                <p class="text-gray-600 text-xs">
                    Setup produk Anda disini
                </p>
            </div>

            <div class="flex gap-2">
                <p-button styleClass="p-button-sm p-button-warning mr-3" label="Sync Pembelian" icon="pi pi-sync"
                    (onClick)="handleSyncPembelian()">
                </p-button>

                <p-button styleClass="p-button-sm p-button-secondary" label="Tambah" icon="pi pi-plus"
                    (onClick)="onClickButtonAdd()">
                </p-button>

                <p-button styleClass="p-button-sm p-button-info" label="Export" (onClick)="menu.toggle($event)"
                    icon="pi pi-file">
                </p-button>

                <p-menu #menu [model]="items" [popup]="true"></p-menu>
            </div>

        </div>

        <div class="grid">
            <app-grid [props]="GridProps" (rowDoubleClicked)="onRowDoubleClicked($event)">
            </app-grid>
        </div>
    </div>

    <!-- Form -->
    <div *ngIf="FormState != 'list'" class="flex flex-col gap-3">
        <div class="flex justify-between items-center bg-white rounded-md p-3 w-full md:w-10/12">
            <div class="flex flex-col gap-0">
                <p class="text-blue-500 text-lg font-semibold">
                    Setup Produk
                </p>
                <p class="text-gray-600 text-xs">
                    Tambah / Update produk Anda disini
                </p>
            </div>


            <div class="flex justify-end gap-2">
                <p-button styleClass="p-button-sm p-button-secondary" label="Kembali" icon="pi pi-chevron-left"
                    (onClick)="FormState = 'list'">
                </p-button>

                <p-button styleClass="p-button-sm p-button-{{ FormState == 'new' ? 'info' : 'warning' }}"
                    [label]="FormState == 'new' ? 'Simpan' : 'Update'" icon="pi pi-save"
                    (onClick)="FormState == 'new' ? handleSave() : handleUpdate()">
                </p-button>
            </div>
        </div>

        <div class="grid grid-rows-4 grid-cols-2 grid-flow-col gap-3 w-full md:w-10/12 bg-white rounded-md p-3"
            [formGroup]="Form">
            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Nama Produk
                    <span class="text-xs text-red-600">*</span>
                </p>
                <input type="text" pInputText class="p-inputtext-sm w-full" formControlName="nama_barang">
            </div>

            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Barcode / Kode Barang
                    <span class="text-xs text-red-600">*</span>
                </p>
                <input type="text" pInputText class="p-inputtext-sm w-full" formControlName="barcode">
            </div>

            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Brand / Merk
                </p>
                <input type="text" pInputText class="p-inputtext-sm w-full" formControlName="brand">
            </div>

            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Ukuran (Inch) (Velg)
                </p>
                <p-inputNumber class="p-inputtext-sm w-full" formControlName="ukuran"></p-inputNumber>
            </div>

            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Satuan
                    <span class="text-xs text-red-600">*</span>
                </p>
                <p-dropdown [filter]="true" [options]="Satuan$ | async" optionLabel="nama_satuan" optionValue="id"
                    [autoDisplayFirst]="false" class="p-inputtext-sm w-full" formControlName="id_satuan">
                </p-dropdown>
            </div>

            <div class="flex flex-col w-full gap-1">
                <p class="text-gray-600 text-sm">
                    Harga Jual
                    <span class="text-xs text-red-600">*</span>
                </p>
                <p-inputNumber class="p-inputtext-sm w-full" formControlName="harga_jual"></p-inputNumber>
            </div>

            <!-- Gambar -->
            <div class="flex flex-col gap-1 mb-3">
                <label for="username" class="text-gray-600 text-sm">
                    Gambar
                </label>

                <input pInputText id="imageEl" type="file" class="p-inputtext-sm w-full" accept="image/*"
                    (change)="handleChangeImage($event)" />
            </div>

            <div *ngIf="FormState == 'update'" class="flex flex-col w-full p-3 border-dashed border-gray-200">
                <p class="text-sm font-medium mb-2">
                    Image Preview
                </p>

                <div class="flex w-full items-center justify-center">
                    <img [src]="Form.get('image')?.value" alt="image"
                        class="w-auto h-[10rem] object-cover object-center">
                </div>
            </div>
        </div>
    </div>
</app-layout>